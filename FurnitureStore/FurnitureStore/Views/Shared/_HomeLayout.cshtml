@using Microsoft.AspNetCore.Http;
@functions{
	async Task AuthenticationInterface(string controller)
	{
		if (Context.Session.GetInt32("UserID") != null)
		{
			decimal? id = (decimal)Context.Session.GetInt32("UserID");
			ModelContext context = new ModelContext();
			User user = context.Users.FirstOrDefault(user => user.Id == id);
			<li><a asp-action="Logout" asp-controller="@controller">log out</a></li>
			<li><a asp-action="Edit" asp-controller="Client" asp-route-id="@id">@user.Firstname @user.Lastname</a></li>
		}
		else
		{
			<li><a asp-action="Login" asp-controller="@controller">log in</a></li>
			<li><a asp-action="Register" asp-controller="@controller">register</a></li>
		}
	}
	async Task ShowUserBag()
	{
		ModelContext context = new ModelContext();
		decimal total = 0;
		<li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown">
				<span class="lnr lnr-cart"></span>
				@if (Context.Session.GetInt32("UserID") == null)
				{
					<span class="badge badge-bg-1">0</span>
				}
				else
				{
					<span class="badge badge-bg-1">@context.Bags.Where(bag=>bag.UserId==(decimal)Context.Session.GetInt32("UserID")).Count()</span>
				}
			</a>
			<ul class="dropdown-menu cart-list s-cate">
				@if (Context.Session.GetInt32("UserID") != null)
				{
					var userBag = context.Bags.Where(bag => bag.UserId == (decimal)Context.Session.GetInt32("UserID")).ToList();
					foreach(Bag bag in userBag)
					{
						var furniture = context.Furnitures.Where(f => f.Id == bag.FurnitureId).FirstOrDefault();
						decimal price = furniture.Price;
						var offer = context.Offers.Where(ofr => ofr.FurnitureId == bag.FurnitureId && ofr.EndDate >= DateTime.Today && ofr.StartDate <= DateTime.Today).OrderByDescending(ofr => ofr.Id).FirstOrDefault();
						if (offer != null) price = price - offer.Percentage * price / 100;
						if (bag.Quantity > bag.Furniture.Quantity) bag.Quantity = (decimal)bag.Furniture.Quantity;
						price *= bag.Quantity;
						total += price;
						<li class="single-cart-list">
							<a asp-action="ShowProduct" asp-controller="Furnitures" asp-route-id="@furniture.Id" class="photo"><img src=@Url.Content("~/Images/"+furniture.Imagepath) class="cart-thumb" alt="image" /></a>
							<div class="cart-list-txt">
								<h6><a asp-action="ShowProduct" asp-controller="Furnitures" asp-route-id="@furniture.Id">@furniture.Name</a></h6>
								<p>@bag.Quantity x - <span class="price">$@price</span></p>
							</div><!--/.cart-list-txt-->
							<div class="cart-close">
								<span class="lnr lnr-cross"></span>
							</div><!--/.cart-close-->
						</li><!--/.single-cart-list -->
					}
				}
				<li class="total">
					<span>Total: $@total</span>
					@if(Context.Session.GetInt32("UserID") == null)
					{
						<a class="btn-cart pull-right" asp-action="Login" asp-controller="Authentication" style="text-align:center">view cart</a>
					}
					else
					{
						<a class="btn-cart pull-right" asp-action="ShowBag" asp-controller="Activites" style="text-align:center">view cart</a>
					}
				</li>
			</ul>
		</li>
		<!--/.dropdown-->
	}
	async Task Logo()
	{
		ModelContext context = new ModelContext();
		var logo = context.Pages.FirstOrDefault();
		<a asp-action="Index" asp-controller="Home">
			<img src="~/Images/@logo.MainLogoPath" alt="Furniture zone" style="width:100px;height:60px;"/>
		</a>
	}
	void Contact()
	{
		ModelContext context = new ModelContext();
		var contact = context.ContactInfos.FirstOrDefault();
		<h1>
			<a href="@contact.Facebook"><i class="fa fa-facebook"></i></a>
			<a href="@contact.Instagram"><i class="fa fa-instagram"></i></a>
			<a href="@contact.Fax"><i class="fa fa-linkedin"></i></a>
			<a href="@contact.Youtube"><i class="fa fa-youtube-play"></i></a>
			<a href="@contact.Twitter"><i class="fa fa-twitter"></i></a>
		</h1>
	}
	void SocialMedia()
	{
		ModelContext context = new ModelContext();
		var social = context.ContactInfos.FirstOrDefault();
		<li><a href="@social.Facebook">Facebook</a></li>

		<!--/li-->
		<li><a href="@social.Instagram">Instagram</a></li>

		<!--/li-->
		<li><a href="@social.Twitter">Twitter</a></li>

		<!--/li-->
		<li><a href="@social.Youtube">Youtube</a></li>

		<!--/li-->
		<li><a href="@social.Fax">LinkedIn</a></li>

		<!--/li-->
	}
	void ContactUs()
	{
		ModelContext context = new ModelContext();
		var social = context.ContactInfos.FirstOrDefault();
		<li><a href="tel:+@social.Phone">call us</a></li>
		<li><a href="mailto:@social.Email">email us</a></li>
	}

}
<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width" />
    <title>@ViewBag.Title</title>



	<!-- meta data -->
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->

        <!--font-family-->
		<link href="https://fonts.googleapis.com/css?family=Roboto:100,100i,300,300i,400,400i,500,500i,700,700i,900,900i" rel="stylesheet">
        
        <!-- title of site -->
        <title>Furniture</title>

        <!-- For favicon png -->
		<link rel="shortcut icon" type="image/icon" href="~/HomeAssets/logo/favicon.png"/>
       
        <!--font-awesome.min.css-->
        <link rel="stylesheet" href="~/HomeAssets/css/font-awesome.min.css">

        <!--linear icon css-->
		<link rel="stylesheet" href="~/HomeAssets/css/linearicons.css">

		<!--animate.css-->
        <link rel="stylesheet" href="~/HomeAssets/css/animate.css">

        <!--owl.carousel.css-->
        <link rel="stylesheet" href="~/HomeAssets/css/owl.carousel.min.css">
		<link rel="stylesheet" href="~/HomeAssets/css/owl.theme.default.min.css">
		
        <!--bootstrap.min.css-->
        <link rel="stylesheet" href="~/HomeAssets/css/bootstrap.min.css">
		
		<!-- bootsnav -->
		<link rel="stylesheet" href="~/HomeAssets/css/bootsnav.css" >	
        
        <!--style.css-->
        <link rel="stylesheet" href="~/HomeAssets/css/style.css">
        
        <!--responsive.css-->
        <link rel="stylesheet" href="~/HomeAssets/css/responsive.css">
        
        <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
        <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
		
        <!--[if lt IE 9]>
			<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
			<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
	<link rel="stylesheet" href="~/css/PaymentStyleSheet.css" />

    </head>
<body>
	
	<!--welcome-hero start -->
	<header id="home" class="welcome-hero" style="z-index:auto">
		<!-- top-area Start -->
		<div class="top-area">
			<div class="header-area">
				<!-- Start Navigation -->
				<nav class="navbar navbar-default bootsnav  navbar-sticky navbar-scrollspy" data-minus-value-desktop="70" data-minus-value-mobile="55" data-speed="1000">
					<!-- Start Top Search -->
						
					<div class="top-search">
						<div class="container">
							<div class="row">
								<div class="col-md-6">
									<form method="get" asp-action="Search" asp-controller="Furnitures" style="display:inline">
										<div class="input-group">
											<span class="input-group-addon"><i class="fa fa-search"></i></span>
											<input type="text" class="form-control" name="name" id="name" placeholder="Search for Furnitures"><!---->
											<span class="input-group-addon close-search"><i class="fa fa-times"></i></span>
											<input type="submit" value="search"/><!---->
										</div>
									</form>
								</div>
								<div class="col-md-6">
									<form method="get" asp-action="Search" asp-controller="Sections" style="display:inline">
										<div class="input-group">
											<span class="input-group-addon"><i class="fa fa-search"></i></span>
											<input type="text" class="form-control" name="name" id="name" placeholder="Search for Sections"><!---->
											<span class="input-group-addon close-search"><i class="fa fa-times"></i></span>
											<input type="submit" value="search" /><!---->
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>
					<!-- End Top Search -->
					<div class="container">
						<!-- Start Atribute Navigation -->
						<div class="attr-nav">
							<ul>
								<li class="search">
									<a href="#"><span class="lnr lnr-magnifier"></span></a>
								</li><!--/.search-->
								<li >
									<a href="#" onclick="myFunction()">🌛</a>
								</li>
								@*'asp-area', 'asp-route', 'asp-protocol', 'asp-host', 'asp-fragment', 'asp-page' or 'asp-page-handler'
								<li class="scroll">
									<a href="/Home/Index#ContactUsForm" >
										<span class="glyphicon glyphicon-envelope"></span>
									</a>
								</li><!--/.search-->*@
								@{
									await ShowUserBag();
								}
							</ul>
						</div><!--/.attr-nav-->
						<!-- End Atribute Navigation -->
						<!-- Start Header Navigation -->
						<div class="navbar-header">
							<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navbar-menu">
								<i class="fa fa-bars"></i>
							</button>
							@{
								await Logo();
							}
						</div><!--/.navbar-header-->
						<!-- End Header Navigation -->
						
						<!-- Collect the nav links, forms, and other content for toggling -->
						<div class="collapse navbar-collapse menu-ui-design" id="navbar-menu">
							<ul class="nav navbar-nav navbar-center" data-in="fadeInDown" data-out="fadeOutUp">
								
								<li><a asp-action="Index" asp-controller="Home">home</a></li>
								<li ><a asp-action="Search" asp-controller="Sections">sections</a></li>
								<li ><a asp-action="Search" asp-controller="Furnitures">products</a></li>
								<li ><a asp-action="About" asp-controller="Home" asp-route-id="16">about</a></li>
								@*<li><a asp-action="Login" asp-controller="Authentication">log in</a></li>
								<li><a asp-action="Register" asp-controller="Authentication">register</a></li>*@
								@{
									await AuthenticationInterface("Authentication");
								}
							</ul><!--/.nav -->
						</div><!-- /.navbar-collapse -->
					</div><!--/.container-->
				</nav><!--/nav-->
				<!-- End Navigation -->
			</div><!--/.header-area-->
			<div class="clearfix"></div>
		</div><!-- /.top-area-->
		<!-- top-area End -->
	</header><!--/.welcome-hero-->
	<!--welcome-hero end -->
    <div>
        @RenderBody()
    </div>
	<!--newsletter strat -->
	<section id="newsletter"  class="newsletter">
		<div class="container">
			<div class="hm-footer-details">
				<div class="row">
					<div class="col-md-4 col-sm-6 col-xs-12">
					<div class="hm-footer-widget">
						<div class="hm-foot-title">
							<h4>Our site</h4>
						</div><!--/.hm-foot-title-->
						<div class="hm-foot-menu">
							<ul>
								<li><a asp-action="Search" asp-controller="Sections">Sections</a></li><!--/li-->
								<li><a asp-action="Search" asp-controller="Furniutres">Products</a></li><!--/li-->
								<li><a asp-action="About">about us</a></li><!--/li-->
								<li><a href="#ContactUsForm">contact us</a></li><!--/li-->
								<li><a asp-action="ListAll" asp-controller="Testimonials">Testimonials</a></li>
							</ul><!--/ul-->
						</div><!--/.hm-foot-menu-->
					</div><!--/.hm-footer-widget-->
					</div><!--/.col-->
					<div class="col-md-4 col-sm-6 col-xs-12">
						<div class="hm-footer-widget">
							<div class="hm-foot-title">
								<h4>Social media</h4>
							</div><!--/.hm-foot-title-->
							<div class="hm-foot-menu">
								<ul>
									@{
										SocialMedia();
									}
								</ul><!--/ul-->
							</div><!--/.hm-foot-menu-->
						</div><!--/.hm-footer-widget-->
					</div><!--/.col-->
					<div class="col-md-4 col-sm-6 col-xs-12">
						<div class="hm-footer-widget">
							<div class="hm-foot-title">
								<h4>Contact us</h4>
							</div><!--/.hm-foot-title-->
							<div class="hm-foot-menu">
								<ul>
									@{
										ContactUs();
									}
								</ul><!--/ul-->
							</div><!--/.hm-foot-menu-->
						</div><!--/.hm-footer-widget-->
					</div><!--/.col-->
				</div><!--/.row-->
			</div><!--/.hm-footer-details-->
		</div><!--/.container-->
	</section><!--/newsletter-->	
	<!--newsletter end -->
	<!--footer start-->
	<footer id="footer"  class="footer">
		<div class="container">
			<div class="hm-footer-copyright text-center">
				<div class="footer-social" >
				@{
					Contact();
				}
				</div>
				<p>
					&copy;copyright. designed and developed by <a href="https://www.themesine.com/">themesine</a>
				</p><!--/p-->
			</div><!--/.text-center-->
		</div><!--/.container-->
		<div id="scroll-Top">
			<div class="return-to-top">
				<i class="fa fa-angle-up " id="scroll-top" data-toggle="tooltip" data-placement="top" title="" data-original-title="Back to Top" aria-hidden="true"></i>
			</div>
		</div><!--/.scroll-Top-->
	</footer><!--/.footer-->
	<!--footer end-->

	<!-- Include all js compiled plugins (below), or include individual files as needed -->

	<script src="~/HomeAssets/js/jquery.js"></script>

	<!--modernizr.min.js-->
	<script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.8.3/modernizr.min.js"></script>

	<!--bootstrap.min.js-->
	<script src="~/HomeAssets/js/bootstrap.min.js"></script>

	<!-- bootsnav js -->
	<script src="~/HomeAssets/js/bootsnav.js"></script>

	<!--owl.carousel.js-->
	<script src="~/HomeAssets/js/owl.carousel.min.js"></script>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-easing/1.4.1/jquery.easing.min.js"></script>

	<!--Custom JS-->
	<script src="~/HomeAssets/js/custom.js"></script>



	<script>
		document.addEventListener("DOMContentLoaded", function () {
			if (localStorage.getItem("mode") === "dark") {
				document.body.classList.add("dark");
			}
		});

		function myFunction() {
			// Get the current mode from local storage
			var currentMode = localStorage.getItem("mode");

			// Toggle the "dark" class on the body
			var element = document.body;
			element.classList.toggle("dark");

			// Update the current mode in local storage
			if (currentMode === "dark") {
				localStorage.setItem("mode", "light");
			} else {
				localStorage.setItem("mode", "dark");
			}
		}
	</script>
	<style>
		.dark {
			background-color: #222;
			color: #e6e6e6;
		}
	</style>

	</body>
</html>